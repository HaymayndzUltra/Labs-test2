---
description: "TAGS: [enterprise,planning,nextjs,nestjs] | TRIGGERS: BR,AP,LA,LB,LC,CS,QA,PR,HP | SCOPE: project-rules | DESCRIPTION: Enterprise Next.js + NestJS plan with lanes, conflicts, and guided triggers. No deploy."
alwaysApply: false
---

# Enterprise Plan — Next.js + NestJS

## [STRICT] Scope
- From brief → DAG → Blocking/Independent → Lanes A/B/(C) → Conflicts → Guided triggers.
- Ends at PR evidence. MUST NOT propose or trigger deployment.

## [STRICT] Inputs
- brief_paths, context (name, industry=enterprise, project_type=fullstack), optional: database=postgres, auth=cognito|auth0.

## [STRICT] Lanes and Milestones
- Lane A (Backend/NestJS): A1 scaffold+env → A2 db+schema+migrations → A3 authN/RBAC → A4 API contracts+endpoints.
- Lane B (Frontend/Next.js): B1 shell+design → B2 auth flows+guards → B3 pages+API wiring.
- Lane C (DevOps/Compliance): C1 CI/QA gates → C2 observability+audit.

## [STRICT] Conflict Checks
- Migrations vs seed/tests (sequence + migration lock).
- Same file/route ownership (branch/feature-flag/mock).
- Port 3000/8000 clashes (assign alt).
- Secrets/env (no plaintext; env-injection).
- No installs/writes inside template-packs/*.

## [STRICT] Triggers
- BR: read brief, build DAG, mark Blocking/Independent, split lanes, list conflicts; Next: AP.
- AP: freeze plan; print “GO: LA + LB (+ LC)”.
- LA: execute Lane A until first milestone/block; then print next allowed triggers (LB or CS).
- LB: same for Lane B.
- LC: same for Lane C (only if defined).
- CS: re-scan conflicts; output guardrails and resequencing.
- QA: run tests/coverage/lints for completed scope; report.
- PR: emit PR evidence (acceptance, artifacts, risks). STOP.
- HP: help/status; show current go-signal and blockers.

## [GUIDELINE] Acceptance per Lane
- A2: migrations up/down + seed ok; A3: 401/403 enforced; A4: OpenAPI+contract tests.
- B2: login/guard/timeout=15m; B3: error states handled.
- C1: coverage ≥80%, SAST/DAST/SBOM; C2: correlation IDs, no secrets in logs.

## [STRICT] Safety
- No deploy. No secrets. No writes or installs inside template-packs/*.